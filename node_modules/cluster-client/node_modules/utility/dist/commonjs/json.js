"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.writeJSON = exports.readJSON = exports.writeJSONSync = exports.readJSONSync = exports.strictJSONParse = void 0;
const node_path_1 = require("node:path");
const node_fs_1 = require("node:fs");
const promises_1 = require("node:fs/promises");
function strictJSONParse(content) {
    const obj = JSON.parse(content);
    if (!obj || typeof obj !== 'object') {
        throw new Error('JSON string is not object');
    }
    return obj;
}
exports.strictJSONParse = strictJSONParse;
function readJSONSync(filepath) {
    return JSON.parse((0, node_fs_1.readFileSync)(filepath, 'utf8'));
}
exports.readJSONSync = readJSONSync;
function writeJSONSync(filepath, content, options = {}) {
    options.space = options.space ?? 2;
    if (typeof content === 'object') {
        content = JSON.stringify(content, options.replacer, options.space) + '\n';
    }
    (0, node_fs_1.mkdirSync)((0, node_path_1.dirname)(filepath), { recursive: true });
    (0, node_fs_1.writeFileSync)(filepath, content);
}
exports.writeJSONSync = writeJSONSync;
async function readJSON(filepath) {
    const content = await (0, promises_1.readFile)(filepath, 'utf8');
    return JSON.parse(content);
}
exports.readJSON = readJSON;
async function writeJSON(filepath, content, options = {}) {
    options.space = options.space ?? 2;
    if (typeof content === 'object') {
        content = JSON.stringify(content, options.replacer, options.space) + '\n';
    }
    await (0, promises_1.mkdir)((0, node_path_1.dirname)(filepath), { recursive: true });
    await (0, promises_1.writeFile)(filepath, content, 'utf8');
}
exports.writeJSON = writeJSON;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianNvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9qc29uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHlDQUFvQztBQUNwQyxxQ0FBaUU7QUFDakUsK0NBQThEO0FBRTlELFNBQWdCLGVBQWUsQ0FBNEIsT0FBZTtJQUN4RSxNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBTSxDQUFDO0lBQ3JDLElBQUksQ0FBQyxHQUFHLElBQUksT0FBTyxHQUFHLEtBQUssUUFBUSxFQUFFLENBQUM7UUFDcEMsTUFBTSxJQUFJLEtBQUssQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFDRCxPQUFPLEdBQUcsQ0FBQztBQUNiLENBQUM7QUFORCwwQ0FNQztBQUVELFNBQWdCLFlBQVksQ0FBVSxRQUFnQjtJQUNwRCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBQSxzQkFBWSxFQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBTSxDQUFDO0FBQ3pELENBQUM7QUFGRCxvQ0FFQztBQVlELFNBQWdCLGFBQWEsQ0FBQyxRQUFnQixFQUFFLE9BQXdCLEVBQUUsVUFBZ0MsRUFBRTtJQUMxRyxPQUFPLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDO0lBQ25DLElBQUksT0FBTyxPQUFPLEtBQUssUUFBUSxFQUFFLENBQUM7UUFDaEMsT0FBTyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksQ0FBQztJQUM1RSxDQUFDO0lBQ0QsSUFBQSxtQkFBUyxFQUFDLElBQUEsbUJBQU8sRUFBQyxRQUFRLENBQUMsRUFBRSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ2xELElBQUEsdUJBQWEsRUFBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDbkMsQ0FBQztBQVBELHNDQU9DO0FBRU0sS0FBSyxVQUFVLFFBQVEsQ0FBVSxRQUFnQjtJQUN0RCxNQUFNLE9BQU8sR0FBRyxNQUFNLElBQUEsbUJBQVEsRUFBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDakQsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBTSxDQUFDO0FBQ2xDLENBQUM7QUFIRCw0QkFHQztBQUVNLEtBQUssVUFBVSxTQUFTLENBQUMsUUFBZ0IsRUFBRSxPQUF3QixFQUFFLFVBQWdDLEVBQUU7SUFDNUcsT0FBTyxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUMsS0FBSyxJQUFJLENBQUMsQ0FBQztJQUNuQyxJQUFJLE9BQU8sT0FBTyxLQUFLLFFBQVEsRUFBRSxDQUFDO1FBQ2hDLE9BQU8sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUM7SUFDNUUsQ0FBQztJQUNELE1BQU0sSUFBQSxnQkFBSyxFQUFDLElBQUEsbUJBQU8sRUFBQyxRQUFRLENBQUMsRUFBRSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ3BELE1BQU0sSUFBQSxvQkFBUyxFQUFDLFFBQVEsRUFBRSxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDN0MsQ0FBQztBQVBELDhCQU9DIn0=